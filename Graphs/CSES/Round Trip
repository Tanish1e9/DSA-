CSES link: https://cses.fi/problemset/task/1669

// M-1 isme parent array ka use kie h but usse path pe ek bar aur iterate krna pad jayega
#include<bits/stdc++.h>
using namespace std;
#define int long long
int dfs(int node, auto &adj, auto &vis, auto &parent) {
	vis[node] = true;
	for(int el:adj[node]) {
		if(!vis[el]) {
			parent[el] = node;
			int val = dfs(el, adj, vis, parent);
			if(val!=-1) return val;
		} else if(el != parent[node]) {
			parent[el] = node;
			return el;
		}
	}
	return -1;
}
signed main() {
	ios::sync_with_stdio(false);
	cin.tie(nullptr);
	cout.tie(nullptr);
	int n, m;
	cin >> n >> m;
	vector<vector<int>> adj(n+1);
	for(int i=0;i<m;i++) {
		int a,b;
		cin >> a >> b;
		adj[a].push_back(b);
		adj[b].push_back(a);
	}
	vector<int>vis(n+1,false);
	vector<int>parent(n+1, -1);
	int ans = -1;
	for(int i=1;i<=n;i++) {
		if(vis[i]) continue;
		ans = dfs(i,adj,vis,parent);
		if(ans != -1) break;
	}
	if(ans==-1) cout << "IMPOSSIBLE\n";
	else {
		int start = parent[ans];
		vector<int> path = {ans};
		while(start!=ans) {
			path.push_back(start);
			start = parent[start];
		}
		path.push_back(start);
		cout << path.size() << endl;
		for(int i:path) cout << i << " ";
		cout << endl;
	}
	return 0;	
}


// M-2 Isme simultaneously hi path populate kr de rhe
#include<bits/stdc++.h>
using namespace std;
#define int long long
int dfs(int node, int par, auto &adj, auto &vis, auto &path) {
	vis[node] = true;
	for(int el:adj[node]) {
		if(!vis[el]) {
			int val = dfs(el, node, adj, vis, path);
			if(val==-1) continue;
			if(val==0) return 0;
			path.push_back(node);
			if(val != node) {
				return val;
			} else {
				return 0;
			}
		} else if(el != par) {
			path.push_back(el);
			path.push_back(node);
			return el;
		}
	}
	// 0 means ki path populate ho chuka h bas ab return krte jao
	// -1 means ki path ni mila h ab tk aur explore kro 
	// else means ki ye wala node endpoint hoga path ka to bas apne aap ko push kro aur return kr do
	return -1;
}
signed main() {
	ios::sync_with_stdio(false);
	cin.tie(nullptr);
	cout.tie(nullptr);
	int n, m;
	cin >> n >> m;
	vector<vector<int>> adj(n+1);
	for(int i=0;i<m;i++) {
		int a,b;
		cin >> a >> b;
		adj[a].push_back(b);
		adj[b].push_back(a);
	}
	vector<int>vis(n+1,false);
	vector<int>path;
	for(int i=1;i<=n;i++) {
		if(vis[i]) continue;
		if(dfs(i,-1,adj,vis,path)!=-1) break;
	}
	if(path.size()==0) cout << "IMPOSSIBLE\n";
	else {
		cout << path.size() << endl;
		for(int i:path) cout << i << " ";
		cout << endl;
	}
	return 0;	
}
