CSES link: https://cses.fi/problemset/task/1732/

// Kmp se to ho gya
// Dekh last index ka jo lps value h wo to largest value h samajh aata hi h
// ab na isko draw kr aur 2nd largest length string bhi jara draw krna ... realise kroge
// ki ye 2nd largest string (shuruwat ke 1st largest string ke length par chale jao uska lps value h)
// aur bas aise hi chalte jana h
// Accha question h utna bhi easy nahi h

#include <bits/stdc++.h>
using namespace std;
#define int long long
int find_mask(int r) {
	int j=30;
	for(;j>=0;j--) {
		if((1<<j) & r) break;
	}
	int m = (1<<(j+1)) - 1;
	return m;
}
signed main() {
    ios::sync_with_stdio(false);
	cin.tie(0);
	cout.tie(0);
	
	string s;
	cin >> s;
	int n = s.size();
	vector<int> lps(n, 0);
	int j=0;
	for(int i=1;i<n;i++) {
		while(j>0 && s[i]!=s[j]) j=lps[j-1];
		if(s[i]==s[j]) {
			lps[i] = j+1;
			j++;
		} else {
			lps[i] = 0;
		}
	}
	vector<int> ans;
	j=n-1;
	while(j>=0 && lps[j]>0) {
		ans.push_back(lps[j]);
		j=lps[j]-1;
	}
	reverse(ans.begin(), ans.end());
	for(int i:ans) {
		cout << i << " ";
	}
	cout << endl;
    return 0;
}



// Z-algo bhi dekh lena
